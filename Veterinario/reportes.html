<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="reportes.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/color-calendar/dist/css/theme-basic.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/color-calendar/dist/css/theme-glass.css" />
    <script src="https://cdn.jsdelivr.net/npm/color-calendar/dist/bundle.min.js"></script>
    <style>
        .pie-chart {
            width: 200px;
            height: 200px;
            position: relative;
            border-radius: 50%;
            overflow: hidden;
        }

        .chart {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
            position: absolute;
            transform-origin: center;
        }

        .slice {
            width: 100%;
            height: 100%;
            position: absolute;
            clip: rect(0, 100px, 200px, 0);
            border-radius: 50%;
        }

        #slice1 {
            background-color: lightgreen;
            z-index: 2;
        }

        #slice2 {
            background-color: darkgreen;
            z-index: 1;
        }

        .center-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <a href="index.html" class="header-img">
            <img src="../Imagenes/LogoUAQ.png" />
            <p>Sistema Veterinario</p>
        </a>
        <div class="header-hrefs">
            <a href="citas.html"> SOLICITUDES DE CITA </a>
            <a href="reportes.html"> REPORTES </a>
            <a href="g" id="logout-link"> CERRAR SESIÓN </a>
        </div>
    </div>
    <div class="cuerpo">
        <div class="sobre">
            <div class="filtro">
                <p>Mes a analizar: </p>
                <input type="month" name="mes" id="mes">
            </div>
            <div class="reportes">
                <div class="graficos">
                    <p>Reporte gráficos</p>
                </div>
                <div class="tabla">
                    <p>Reporte tabla</p>
                </div>
            </div>
        </div>
        <div class="contenedor">
            <div class="primerLinea">
                <div class="examenes">
                    <p>tablaaaaa</p>
                </div>
                <div class="color-calendar" id="color-calendar">
                    
                </div>
            </div>
            <div class="segundaLinea">
                <div class="exCard">
                    <canvas id="uri"></canvas>
                </div>
                <div class="exCard">
                    <canvas id="hema"></canvas>
                </div>
                <div class="exCard">
                    <canvas id="para"></canvas>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.0.1/dist/chart.umd.min.js"></script>
    <script>
        let calendar;
        document.addEventListener('DOMContentLoaded', function() {
            const monthInput = document.getElementById('mes');
            const myEvents = [
                {
                    start: '2023-06-15T06:00:00',
                    end: '2023-06-15T20:30:00',
                    name: 'Event 1',
                    url: 'https://www.cssscript.com',
                    desc: 'Description 1',
                    // more key value pairs here
                },{
                    start: '2023-06-16T06:00:00',
                    end: '2023-06-16T20:30:00',
                    name: 'Event 2',
                    url: 'https://www.cssscript.com',
                },{
                    start: '2023-06-17T06:00:00',
                    end: '2023-06-17T20:30:00',
                    name: 'Event 3',
                    url: 'https://www.cssscript.com',
                },
            ]
    
            calendar = new Calendar({
                id: '#color-calendar',
                eventsData: myEvents,
    
                // small or large
                calendarSize: 'small',
                // an array of layout modifiers
                layoutModifiers: ['month-align-left'],
                
                // basic | glass
                theme: 'glass',
                // custom colors
                primaryColor: '#EC407A',
                headerColor: 'white',
                headerBackgroundColor: 'rgba(0, 0, 0, 0.3)',
                weekdaysColor: 'based on theme',
                // short | long-lower | long-upper
                weekdayDisplayType: 'short',
                // short | long
                monthDisplayType: 'long',
                // 0 (Sun)
                startWeekday: 0,
                // font family
                fontFamilyHeader: 'based on theme',
                fontFamilyWeekdays: 'based on theme',
                fontFamilyBody: 'based on theme',
                // shadow CSS
                dropShadow: 'based on theme',
                // border CSS
                border: 'based on theme',
                // border radius
                borderRadius: '0.5rem',
                // disable month year pickers
                disableMonthYearPickers: true,
                // disable click on dates
                disableDayClick: true,
                // disable the arrows to navigate between months
                disableMonthArrowClick: true,
                customWeekdayValues:["Dom", "Lun", "Mar", "Mie", "Jue", "Vie", "Sab"],
            })
            
            // Obtén la fecha actual
            const currentDate = new Date();
            // Obtiene el año y mes actual
            const currentYear = currentDate.getFullYear();
            const currentMonth = (currentDate.getMonth() + 1).toString().padStart(2, '0'); // Asegura que tenga dos dígitos
    
            // Formatea la fecha actual en el formato requerido por el input month
            const formattedDate = `${currentYear}-${currentMonth}`;
            // Establece el valor del input month con la fecha actual
            monthInput.value = formattedDate;
        
            monthInput.addEventListener('change', function(event) {
                // Obtiene el valor seleccionado del input month
                const selectedMonth = event.target.value;

                let dateParts = selectedMonth.split("-");
                let year = parseInt(dateParts[0]);
                let month = parseInt(dateParts[1]);

                // Incrementa el mes en 1
                month += 1;

                // Verifica si el mes es 13 (diciembre), en ese caso, incrementa el año y establece el mes a 1 (enero)
                if (month === 13) {
                year += 1;
                month = 1;
                }

                // Formatea el mes para que tenga dos dígitos
                let formattedMonth = month.toString().padStart(2, "0");

                // Crea la nueva cadena de fecha con el mes incrementado
                let newDateString = `${year}-${formattedMonth}`;
                
                // Actualiza la fecha del calendario con el nuevo mes seleccionado
                calendar.setDate(newDateString);
            });
        })

        var data = {
            labels: ['Completados', 'Pendientes'],
            datasets: [{
                data: [3, 5],
                backgroundColor: ['#4FB099', '#347364']
            }]
        };
        var data2 = {
            labels: ['Completados', 'Pendientes'],
            datasets: [{
                data: [3, 5],
                backgroundColor: ['#B04F4F', '#733434']
            }]
        };
        var data3 = {
            labels: ['Completados', 'Pendientes'],
            datasets: [{
                data: [3, 5],
                backgroundColor: ['#4F99B0', '#31606F']
            }]
        };

        var options = {
            title: {
                display: true,
                text: 'Gráfico de Dona'
            }
        };

        const doughnoutLabel = {
            id: 'doughnoutLabel',
            beforeDatasetsDraw(chart, args, pluginOptions){
                const { ctx, data } = chart;
                ctx.save;
                const xCoor = chart.getDatasetMeta(0).data[0].x;
                const yCoor = chart.getDatasetMeta(0).data[0].y;
                ctx.font = 'bold 25px sans-serif';
                ctx.fillStyle = '#757272';
                ctx.textAlign = 'center';
                ctx.fillText('3/8', xCoor, yCoor);
            }
        }

        new Chart(document.getElementById("uri"),{
            type:"doughnut",
            data:data,
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    title: {
                        display: true,
                        text: 'Urianálisis'
                    }
                },
            },
            plugins: [doughnoutLabel]
        })
        new Chart(document.getElementById("hema"),{
            type:"doughnut",
            data:data2,
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    title: {
                        display: true,
                        text: 'Hematología'
                    }
                },
            },
            plugins: [doughnoutLabel]
        })
        new Chart(document.getElementById("para"),{
            type:"doughnut",
            data:data3,
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    title: {
                        display: true,
                        text: 'Parasitología'
                    }
                },
            },
            plugins: [doughnoutLabel]
        })

    </script>
</body>
</html>